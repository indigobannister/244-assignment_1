---
title: "Task 1"
author: "Indigo Bannister"
date: "1/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# set up libraries
library(tidyverse)
library(here)
library(readxl)
library(lubridate)
library(patchwork)


```
# Task 1: Data wrangling & visualization of Sierra amphibians

### Step 1: Call in data

```{r}
# read in xlsx of data
RAMU <- read_xlsx(here("data","sierra_amphibians.xlsx")) %>% 
  filter(amphibian_species == 'RAMU') %>% 
  mutate(survey_date = ymd(survey_date)) %>% 
  mutate(survey_year = year(survey_date)) 

```

### Step 2: Create a graph of count of Rana muscosa by year, grouped by life stage
```{r}
# Filter, clean, and summarize data for analysis
year_lifestage <- RAMU %>% 
  filter(amphibian_life_stage != 'EggMass') %>% 
  group_by(amphibian_life_stage, survey_year) %>% 
  summarize(count = sum(amphibian_number))

# create graph 
ggplot(data = year_lifestage, aes(x = survey_year, y = count, fill = amphibian_life_stage)) + 
  geom_col() + 
  labs(x = "Year",
       y = "Number of frogs",
       fill = "Life Stage") +
    scale_x_continuous(expand = c(0, 0),
                     breaks = seq(1995, 2002, by = 1)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_minimal() + 
  coord_flip()

```

### Step 3: Create a graph of frog counts observed in the top 5 lakes
```{r}
# Wrangle data for graph: filter initial dataset, select top 5 counts, and adjust naming for graph visual
top5_lakes <- RAMU %>% 
  filter(amphibian_life_stage != 'EggMass') %>% 
  filter(amphibian_life_stage != 'Tadpole') %>% 
  group_by(lake_id) %>% 
  summarize(count = sum(amphibian_number)) %>% 
  slice_max(order_by = count, n = 5) %>% 
  mutate(lake_name = paste('Lake #',lake_id, sep = ' ')) %>% 
  mutate(lake_name = fct_reorder(lake_name, count))

# create graph of frog counts observed in top 5 lakes
  
```



A column graph containing total counts (over all years of the study) of combined adult and subadult endangered mountain yellow-legged frogs (Rana muscosa) observed in the 5 lakes with the greatest total observed counts. In other words, this graph will have at least 5 columns (OK to have more if there are ties - thanks Michelle Shteyn), with Lake ID (these aren’t specified in the dataset for confidentiality) as the categorical label on one axis, and total yellow-legged frog counts (adult + subadult counts) in the dataset on the other axis. Make sure they’re in high-to-low or low-to-high order by total yellow-legged frog counts. You should exclude tadpoles for this graph. Note: Consider reformatting the lake ID from just a number to a label like “Lake 10025”), then use fct_reorder to convert it to an ordered factor.

Combine your two graphs into a single compound figure using the {patchwork} package. Add a finalized figure caption that appears below the compound figure in your knitted html. Note: You might realize once you combine your graphs into a single compound figure, you need to update the formatting (e.g. move legends or instead directly label, etc.). You should customize as necessary to make it a professional final output.

For Task 1, your knitted html should show: 

Your organized code, with clear subsections and any useful descriptive text / annotation (e.g. if you wanted to highlight this as a code example for a prospective employer)
Your finalized compound figure, with a figure caption
Make sure to suppress any messages & warnings
